<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>智能火力规划系统</title>
    <!-- 引入Bootstrap -->
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.2.3/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
<div class="container mt-3">
    <div class="row">
        <div class="col-md-10 offset-md-1">
            <div class="card">
                <div class="card-header">
                    场景文件导入
                </div>
                <div class="card-body">
                    <form id="uploadForm">
                        <div class="mb-3">
                            <label class="form-label">选择文件</label>
                            <input type="file" class="form-control" id="fileInput" name="file" accept=".txt,.csv">
                        </div>
                        <button type="submit" class="btn btn-primary">加载蓝方目标信息</button>
                        <button type="button" class="btn btn-danger ms-3">火力规划问题求解</button>
                    </form>
                </div>
            </div>

            <!-- 结果展示区域 -->
            <div id="resultSummary" class="mt-3" style="display: none;">
                <div class="alert alert-info">
                    目标数量数: <span id="totalRows"></span>
                </div>
            </div>

            <!-- 表格展示区域 -->
            <div id="tableContainer" class="mt-3" style="max-height: 250px; overflow-y: auto">
                <!-- 解析结果将在这里展示 -->
            </div>

            <!-- todo：结果展示区域 -->
            <div id="resultContainer" class="mt-3" style="max-height: 250px; overflow-y: auto">
                <!-- 计算结果将在这里展示 -->
            </div>
        </div>
    </div>
</div>

<script>
$(document).ready(function() {
    $('#uploadForm').on('submit', function(e) {
        e.preventDefault();

        var formData = new FormData(this);

        $.ajax({
            url: '/upload',
            type: 'POST',
            data: formData,
            processData: false,
            contentType: false,
            success: function(response) {
                // 显示表格
                $('#tableContainer').html(response.table_html);

                // 显示摘要信息
                $('#totalRows').text(response.total_rows);
                $('#totalColumns').text(response.total_columns);
                $('#resultSummary').show();
            },
            error: function(xhr) {
                alert('上传失败:' + xhr.responseJSON.error);
            }
        });
    });
});
</script>
</body>
</html>